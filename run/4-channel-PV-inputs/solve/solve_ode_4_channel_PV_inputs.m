function data_file=solve_ode
% ------------------------------------------------------------
% Open output data file:
data_file='data.csv';
fileID=fopen(data_file,'w');
fprintf(fileID,'time,');
for i=1:4, fprintf(fileID,'On_V,'); end
for i=1:4, fprintf(fileID,'On_g_ad,'); end
for i=1:4, fprintf(fileID,'Off_V,'); end
for i=1:4, fprintf(fileID,'Off_g_ad,'); end
for i=1:4, fprintf(fileID,'ROn_V,'); end
for i=1:4, fprintf(fileID,'ROn_g_ad,'); end
for i=1:4, fprintf(fileID,'ROff_V,'); end
for i=1:4, fprintf(fileID,'ROff_g_ad,'); end
for i=1:4, fprintf(fileID,'SOnOff_V,'); end
for i=1:4, fprintf(fileID,'SOnOff_g_ad,'); end
for i=1:4, fprintf(fileID,'TD_V,'); end
for i=1:4, fprintf(fileID,'TD_g_ad,'); end
for i=1:4, fprintf(fileID,'X_V,'); end
for i=1:4, fprintf(fileID,'X_g_ad,'); end
for i=1:1, fprintf(fileID,'C_V,'); end
for i=1:1, fprintf(fileID,'C_g_ad,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_s,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_x,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_F,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_P,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_q,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_s,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_x,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_F,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_P,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_s,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_x,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_F,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_P,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_s,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_x,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_F,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_P,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_s,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_x,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_F,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_P,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_q,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_s,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_x,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_F,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_P,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROn_ROn_iNoise_V3_sn,'); end
for i=1:4, fprintf(fileID,'ROn_ROn_iNoise_V3_xn,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_s,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_x,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_F,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_P,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_s,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_x,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_F,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_P,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_q,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_s,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_x,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_F,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_P,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_q,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_s,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_x,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_F,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_P,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_q,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_s,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_x,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_F,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_P,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_q,'); end
for i=1:4, fprintf(fileID,'C_ROn_PSC3_s,'); end
for i=1:4, fprintf(fileID,'C_ROn_PSC3_x,'); end
for i=1:4, fprintf(fileID,'C_ROn_PSC3_F,'); end
for i=1:4, fprintf(fileID,'C_ROn_PSC3_P,'); end
for i=1:4, fprintf(fileID,'C_ROn_PSC3_q,'); end
for i=1:4, fprintf(fileID,'On_V_spikes,'); end
for i=1:4, fprintf(fileID,'Off_V_spikes,'); end
for i=1:4, fprintf(fileID,'ROn_V_spikes,'); end
for i=1:4, fprintf(fileID,'ROff_V_spikes,'); end
for i=1:4, fprintf(fileID,'SOnOff_V_spikes,'); end
for i=1:4, fprintf(fileID,'TD_V_spikes,'); end
for i=1:4, fprintf(fileID,'X_V_spikes,'); end
for i=1:1, fprintf(fileID,'C_V_spikes,'); end
for i=1:4, fprintf(fileID,'On_On_IC_iIC,'); end
for i=1:4, fprintf(fileID,'Off_Off_IC_iIC,'); end
for i=1:4, fprintf(fileID,'ROn_On_PSC3_syn,'); end
for i=1:4, fprintf(fileID,'SOnOff_On_PSC_syn,'); end
for i=1:4, fprintf(fileID,'ROn_SOnOff_PSC_syn,'); end
for i=1:4, fprintf(fileID,'ROff_SOnOff_PSC_syn,'); end
for i=1:4, fprintf(fileID,'ROff_Off_PSC_syn,'); end
for i=1:4, fprintf(fileID,'SOnOff_Off_PSC_syn,'); end
for i=1:4, fprintf(fileID,'X_ROn_PSC_syn,'); end
for i=1:4, fprintf(fileID,'ROn_X_PSC3_syn,'); end
for i=1:4, fprintf(fileID,'ROn_TD_PSC_syn,'); end
for i=1:4, fprintf(fileID,'ROff_TD_PSC_syn,'); end
for i=1:4, fprintf(fileID,'X_TD_PSC_syn,'); end
for i=1:1, fprintf(fileID,'C_ROn_PSC3_syn,'); end
fprintf(fileID,'\n');

% ------------------------------------------------------------
% Parameters:
% ------------------------------------------------------------
params = load('params.mat','p');
p = params.p;
downsample_factor=p.downsample_factor;
dt=p.dt;
T=(p.tspan(1):dt:p.tspan(2))';
ntime=length(T);
nsamp=length(1:downsample_factor:ntime);

% seed the random number generator
rng(p.random_seed);

% ------------------------------------------------------------
% Fixed variables:
% ------------------------------------------------------------
On_R = 1/p.On_g_L;
On_tau = p.On_C*On_R;
On_Imask =  ones(1,p.On_Npop);
Off_R = 1/p.Off_g_L;
Off_tau = p.Off_C*Off_R;
Off_Imask =  ones(1,p.Off_Npop);
ROn_R = 1/p.ROn_g_L;
ROn_tau = p.ROn_C*ROn_R;
ROn_Imask =  ones(1,p.ROn_Npop);
ROff_R = 1/p.ROff_g_L;
ROff_tau = p.ROff_C*ROff_R;
ROff_Imask =  ones(1,p.ROff_Npop);
SOnOff_R = 1/p.SOnOff_g_L;
SOnOff_tau = p.SOnOff_C*SOnOff_R;
SOnOff_Imask =  ones(1,p.SOnOff_Npop);
TD_R = 1/p.TD_g_L;
TD_tau = p.TD_C*TD_R;
TD_Imask =  ones(1,p.TD_Npop);
TD_Icur =  p.TD_Itonic*buildTonicCurrent(T,p.TD_Npop,dt,p.TD_numLocs);
X_R = 1/p.X_g_L;
X_tau = p.X_C*X_R;
X_Imask =  ones(1,p.X_Npop);
C_R = 1/p.C_g_L;
C_tau = p.C_C*C_R;
C_Imask =  ones(1,p.C_Npop);
On_On_IC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
On_On_IC_input =  genPoissonInputs(p.On_On_IC_trial,p.On_On_IC_locNum,p.On_On_IC_label,p.On_On_IC_t_ref,p.On_On_IC_t_ref_rel,p.On_On_IC_rec);
Off_Off_IC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
Off_Off_IC_input =  genPoissonInputs(p.Off_Off_IC_trial,p.Off_Off_IC_locNum,p.Off_Off_IC_label,p.Off_Off_IC_t_ref,p.Off_Off_IC_t_ref_rel,p.Off_Off_IC_rec);
ROn_On_PSC3_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROn_On_PSC3_scale = (p.ROn_On_PSC3_tauD/p.ROn_On_PSC3_tauR)^(p.ROn_On_PSC3_tauR/(p.ROn_On_PSC3_tauD-p.ROn_On_PSC3_tauR));
SOnOff_On_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
SOnOff_On_PSC_scale = (p.SOnOff_On_PSC_tauD/p.SOnOff_On_PSC_tauR)^(p.SOnOff_On_PSC_tauR/(p.SOnOff_On_PSC_tauD-p.SOnOff_On_PSC_tauR));
ROn_SOnOff_PSC_netcon = p.ROn_SOnOff_PSC_netcon;
ROn_SOnOff_PSC_scale = (p.ROn_SOnOff_PSC_tauD/p.ROn_SOnOff_PSC_tauR)^(p.ROn_SOnOff_PSC_tauR/(p.ROn_SOnOff_PSC_tauD-p.ROn_SOnOff_PSC_tauR));
ROff_SOnOff_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROff_SOnOff_PSC_scale = (p.ROff_SOnOff_PSC_tauD/p.ROff_SOnOff_PSC_tauR)^(p.ROff_SOnOff_PSC_tauR/(p.ROff_SOnOff_PSC_tauD-p.ROff_SOnOff_PSC_tauR));
ROff_Off_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROff_Off_PSC_scale = (p.ROff_Off_PSC_tauD/p.ROff_Off_PSC_tauR)^(p.ROff_Off_PSC_tauR/(p.ROff_Off_PSC_tauD-p.ROff_Off_PSC_tauR));
SOnOff_Off_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
SOnOff_Off_PSC_scale = (p.SOnOff_Off_PSC_tauD/p.SOnOff_Off_PSC_tauR)^(p.SOnOff_Off_PSC_tauR/(p.SOnOff_Off_PSC_tauD-p.SOnOff_Off_PSC_tauR));
ROn_ROn_iNoise_V3_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROn_ROn_iNoise_V3_token = genPoissonTimes(p.ROn_Npop,p.ROn_ROn_iNoise_V3_dt,p.ROn_ROn_iNoise_V3_FR,p.ROn_ROn_iNoise_V3_sigma,p.ROn_ROn_iNoise_V3_simlen);
ROn_ROn_iNoise_V3_scale =  (p.ROn_ROn_iNoise_V3_tauD_N/p.ROn_ROn_iNoise_V3_tauR_N)^(p.ROn_ROn_iNoise_V3_tauR_N/(p.ROn_ROn_iNoise_V3_tauD_N-p.ROn_ROn_iNoise_V3_tauR_N));
X_ROn_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
X_ROn_PSC_scale = (p.X_ROn_PSC_tauD/p.X_ROn_PSC_tauR)^(p.X_ROn_PSC_tauR/(p.X_ROn_PSC_tauD-p.X_ROn_PSC_tauR));
ROn_X_PSC3_netcon = p.ROn_X_PSC3_netcon;
ROn_X_PSC3_scale = (p.ROn_X_PSC3_tauD/p.ROn_X_PSC3_tauR)^(p.ROn_X_PSC3_tauR/(p.ROn_X_PSC3_tauD-p.ROn_X_PSC3_tauR));
ROn_TD_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROn_TD_PSC_scale = (p.ROn_TD_PSC_tauD/p.ROn_TD_PSC_tauR)^(p.ROn_TD_PSC_tauR/(p.ROn_TD_PSC_tauD-p.ROn_TD_PSC_tauR));
ROff_TD_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
ROff_TD_PSC_scale = (p.ROff_TD_PSC_tauD/p.ROff_TD_PSC_tauR)^(p.ROff_TD_PSC_tauR/(p.ROff_TD_PSC_tauD-p.ROff_TD_PSC_tauR));
X_TD_PSC_netcon = [+1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00   +0.000000000000000e+00; +0.000000000000000e+00   +0.000000000000000e+00   +0.000000000000000e+00   +1.000000000000000e+00];
X_TD_PSC_scale = (p.X_TD_PSC_tauD/p.X_TD_PSC_tauR)^(p.X_TD_PSC_tauR/(p.X_TD_PSC_tauD-p.X_TD_PSC_tauR));
C_ROn_PSC3_netcon = [+1.000000000000000e+00; +1.000000000000000e+00; +1.000000000000000e+00; +1.000000000000000e+00];
C_ROn_PSC3_scale = (p.C_ROn_PSC3_tauD/p.C_ROn_PSC3_tauR)^(p.C_ROn_PSC3_tauR/(p.C_ROn_PSC3_tauD-p.C_ROn_PSC3_tauR));

% ------------------------------------------------------------
% Initial conditions:
% ------------------------------------------------------------
t=0; k=1;
fprintf(fileID,'0,');

% STATE_VARIABLES:
On_V_last =  p.On_E_L*ones(1,p.On_Npop);
for i=1:numel(On_V_last), fprintf(fileID,'%g,',On_V_last(i)); end
On_g_ad_last =  zeros(1,p.On_Npop);
for i=1:numel(On_g_ad_last), fprintf(fileID,'%g,',On_g_ad_last(i)); end
Off_V_last =  p.Off_E_L*ones(1,p.Off_Npop);
for i=1:numel(Off_V_last), fprintf(fileID,'%g,',Off_V_last(i)); end
Off_g_ad_last =  zeros(1,p.Off_Npop);
for i=1:numel(Off_g_ad_last), fprintf(fileID,'%g,',Off_g_ad_last(i)); end
ROn_V_last =  p.ROn_E_L*ones(1,p.ROn_Npop);
for i=1:numel(ROn_V_last), fprintf(fileID,'%g,',ROn_V_last(i)); end
ROn_g_ad_last =  zeros(1,p.ROn_Npop);
for i=1:numel(ROn_g_ad_last), fprintf(fileID,'%g,',ROn_g_ad_last(i)); end
ROff_V_last =  p.ROff_E_L*ones(1,p.ROff_Npop);
for i=1:numel(ROff_V_last), fprintf(fileID,'%g,',ROff_V_last(i)); end
ROff_g_ad_last =  zeros(1,p.ROff_Npop);
for i=1:numel(ROff_g_ad_last), fprintf(fileID,'%g,',ROff_g_ad_last(i)); end
SOnOff_V_last =  p.SOnOff_E_L*ones(1,p.SOnOff_Npop);
for i=1:numel(SOnOff_V_last), fprintf(fileID,'%g,',SOnOff_V_last(i)); end
SOnOff_g_ad_last =  zeros(1,p.SOnOff_Npop);
for i=1:numel(SOnOff_g_ad_last), fprintf(fileID,'%g,',SOnOff_g_ad_last(i)); end
TD_V_last =  p.TD_E_L*ones(1,p.TD_Npop);
for i=1:numel(TD_V_last), fprintf(fileID,'%g,',TD_V_last(i)); end
TD_g_ad_last =  zeros(1,p.TD_Npop);
for i=1:numel(TD_g_ad_last), fprintf(fileID,'%g,',TD_g_ad_last(i)); end
X_V_last =  p.X_E_L*ones(1,p.X_Npop);
for i=1:numel(X_V_last), fprintf(fileID,'%g,',X_V_last(i)); end
X_g_ad_last =  zeros(1,p.X_Npop);
for i=1:numel(X_g_ad_last), fprintf(fileID,'%g,',X_g_ad_last(i)); end
C_V_last =  p.C_E_L*ones(1,p.C_Npop);
for i=1:numel(C_V_last), fprintf(fileID,'%g,',C_V_last(i)); end
C_g_ad_last =  zeros(1,p.C_Npop);
for i=1:numel(C_g_ad_last), fprintf(fileID,'%g,',C_g_ad_last(i)); end
ROn_On_PSC3_s_last =  zeros(1,p.On_Npop);
for i=1:numel(ROn_On_PSC3_s_last), fprintf(fileID,'%g,',ROn_On_PSC3_s_last(i)); end
ROn_On_PSC3_x_last =  zeros(1,p.On_Npop);
for i=1:numel(ROn_On_PSC3_x_last), fprintf(fileID,'%g,',ROn_On_PSC3_x_last(i)); end
ROn_On_PSC3_F_last =  ones(1,p.On_Npop);
for i=1:numel(ROn_On_PSC3_F_last), fprintf(fileID,'%g,',ROn_On_PSC3_F_last(i)); end
ROn_On_PSC3_P_last =  ones(1,p.On_Npop);
for i=1:numel(ROn_On_PSC3_P_last), fprintf(fileID,'%g,',ROn_On_PSC3_P_last(i)); end
ROn_On_PSC3_q_last =  ones(1,p.On_Npop);
for i=1:numel(ROn_On_PSC3_q_last), fprintf(fileID,'%g,',ROn_On_PSC3_q_last(i)); end
SOnOff_On_PSC_s_last =  zeros(1,p.On_Npop);
for i=1:numel(SOnOff_On_PSC_s_last), fprintf(fileID,'%g,',SOnOff_On_PSC_s_last(i)); end
SOnOff_On_PSC_x_last =  zeros(1,p.On_Npop);
for i=1:numel(SOnOff_On_PSC_x_last), fprintf(fileID,'%g,',SOnOff_On_PSC_x_last(i)); end
SOnOff_On_PSC_F_last =  ones(1,p.On_Npop);
for i=1:numel(SOnOff_On_PSC_F_last), fprintf(fileID,'%g,',SOnOff_On_PSC_F_last(i)); end
SOnOff_On_PSC_P_last =  ones(1,p.On_Npop);
for i=1:numel(SOnOff_On_PSC_P_last), fprintf(fileID,'%g,',SOnOff_On_PSC_P_last(i)); end
SOnOff_On_PSC_q_last =  ones(1,p.On_Npop);
for i=1:numel(SOnOff_On_PSC_q_last), fprintf(fileID,'%g,',SOnOff_On_PSC_q_last(i)); end
ROn_SOnOff_PSC_s_last =  zeros(1,p.SOnOff_Npop);
for i=1:numel(ROn_SOnOff_PSC_s_last), fprintf(fileID,'%g,',ROn_SOnOff_PSC_s_last(i)); end
ROn_SOnOff_PSC_x_last =  zeros(1,p.SOnOff_Npop);
for i=1:numel(ROn_SOnOff_PSC_x_last), fprintf(fileID,'%g,',ROn_SOnOff_PSC_x_last(i)); end
ROn_SOnOff_PSC_F_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROn_SOnOff_PSC_F_last), fprintf(fileID,'%g,',ROn_SOnOff_PSC_F_last(i)); end
ROn_SOnOff_PSC_P_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROn_SOnOff_PSC_P_last), fprintf(fileID,'%g,',ROn_SOnOff_PSC_P_last(i)); end
ROn_SOnOff_PSC_q_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROn_SOnOff_PSC_q_last), fprintf(fileID,'%g,',ROn_SOnOff_PSC_q_last(i)); end
ROff_SOnOff_PSC_s_last =  zeros(1,p.SOnOff_Npop);
for i=1:numel(ROff_SOnOff_PSC_s_last), fprintf(fileID,'%g,',ROff_SOnOff_PSC_s_last(i)); end
ROff_SOnOff_PSC_x_last =  zeros(1,p.SOnOff_Npop);
for i=1:numel(ROff_SOnOff_PSC_x_last), fprintf(fileID,'%g,',ROff_SOnOff_PSC_x_last(i)); end
ROff_SOnOff_PSC_F_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROff_SOnOff_PSC_F_last), fprintf(fileID,'%g,',ROff_SOnOff_PSC_F_last(i)); end
ROff_SOnOff_PSC_P_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROff_SOnOff_PSC_P_last), fprintf(fileID,'%g,',ROff_SOnOff_PSC_P_last(i)); end
ROff_SOnOff_PSC_q_last =  ones(1,p.SOnOff_Npop);
for i=1:numel(ROff_SOnOff_PSC_q_last), fprintf(fileID,'%g,',ROff_SOnOff_PSC_q_last(i)); end
ROff_Off_PSC_s_last =  zeros(1,p.Off_Npop);
for i=1:numel(ROff_Off_PSC_s_last), fprintf(fileID,'%g,',ROff_Off_PSC_s_last(i)); end
ROff_Off_PSC_x_last =  zeros(1,p.Off_Npop);
for i=1:numel(ROff_Off_PSC_x_last), fprintf(fileID,'%g,',ROff_Off_PSC_x_last(i)); end
ROff_Off_PSC_F_last =  ones(1,p.Off_Npop);
for i=1:numel(ROff_Off_PSC_F_last), fprintf(fileID,'%g,',ROff_Off_PSC_F_last(i)); end
ROff_Off_PSC_P_last =  ones(1,p.Off_Npop);
for i=1:numel(ROff_Off_PSC_P_last), fprintf(fileID,'%g,',ROff_Off_PSC_P_last(i)); end
ROff_Off_PSC_q_last =  ones(1,p.Off_Npop);
for i=1:numel(ROff_Off_PSC_q_last), fprintf(fileID,'%g,',ROff_Off_PSC_q_last(i)); end
SOnOff_Off_PSC_s_last =  zeros(1,p.Off_Npop);
for i=1:numel(SOnOff_Off_PSC_s_last), fprintf(fileID,'%g,',SOnOff_Off_PSC_s_last(i)); end
SOnOff_Off_PSC_x_last =  zeros(1,p.Off_Npop);
for i=1:numel(SOnOff_Off_PSC_x_last), fprintf(fileID,'%g,',SOnOff_Off_PSC_x_last(i)); end
SOnOff_Off_PSC_F_last =  ones(1,p.Off_Npop);
for i=1:numel(SOnOff_Off_PSC_F_last), fprintf(fileID,'%g,',SOnOff_Off_PSC_F_last(i)); end
SOnOff_Off_PSC_P_last =  ones(1,p.Off_Npop);
for i=1:numel(SOnOff_Off_PSC_P_last), fprintf(fileID,'%g,',SOnOff_Off_PSC_P_last(i)); end
SOnOff_Off_PSC_q_last =  ones(1,p.Off_Npop);
for i=1:numel(SOnOff_Off_PSC_q_last), fprintf(fileID,'%g,',SOnOff_Off_PSC_q_last(i)); end
ROn_ROn_iNoise_V3_sn_last =  0 * ones(1,p.ROn_Npop);
for i=1:numel(ROn_ROn_iNoise_V3_sn_last), fprintf(fileID,'%g,',ROn_ROn_iNoise_V3_sn_last(i)); end
ROn_ROn_iNoise_V3_xn_last =  0 * ones(1,p.ROn_Npop);
for i=1:numel(ROn_ROn_iNoise_V3_xn_last), fprintf(fileID,'%g,',ROn_ROn_iNoise_V3_xn_last(i)); end
X_ROn_PSC_s_last =  zeros(1,p.ROn_Npop);
for i=1:numel(X_ROn_PSC_s_last), fprintf(fileID,'%g,',X_ROn_PSC_s_last(i)); end
X_ROn_PSC_x_last =  zeros(1,p.ROn_Npop);
for i=1:numel(X_ROn_PSC_x_last), fprintf(fileID,'%g,',X_ROn_PSC_x_last(i)); end
X_ROn_PSC_F_last =  ones(1,p.ROn_Npop);
for i=1:numel(X_ROn_PSC_F_last), fprintf(fileID,'%g,',X_ROn_PSC_F_last(i)); end
X_ROn_PSC_P_last =  ones(1,p.ROn_Npop);
for i=1:numel(X_ROn_PSC_P_last), fprintf(fileID,'%g,',X_ROn_PSC_P_last(i)); end
X_ROn_PSC_q_last =  ones(1,p.ROn_Npop);
for i=1:numel(X_ROn_PSC_q_last), fprintf(fileID,'%g,',X_ROn_PSC_q_last(i)); end
ROn_X_PSC3_s_last =  zeros(1,p.X_Npop);
for i=1:numel(ROn_X_PSC3_s_last), fprintf(fileID,'%g,',ROn_X_PSC3_s_last(i)); end
ROn_X_PSC3_x_last =  zeros(1,p.X_Npop);
for i=1:numel(ROn_X_PSC3_x_last), fprintf(fileID,'%g,',ROn_X_PSC3_x_last(i)); end
ROn_X_PSC3_F_last =  ones(1,p.X_Npop);
for i=1:numel(ROn_X_PSC3_F_last), fprintf(fileID,'%g,',ROn_X_PSC3_F_last(i)); end
ROn_X_PSC3_P_last =  ones(1,p.X_Npop);
for i=1:numel(ROn_X_PSC3_P_last), fprintf(fileID,'%g,',ROn_X_PSC3_P_last(i)); end
ROn_X_PSC3_q_last =  ones(1,p.X_Npop);
for i=1:numel(ROn_X_PSC3_q_last), fprintf(fileID,'%g,',ROn_X_PSC3_q_last(i)); end
ROn_TD_PSC_s_last =  zeros(1,p.TD_Npop);
for i=1:numel(ROn_TD_PSC_s_last), fprintf(fileID,'%g,',ROn_TD_PSC_s_last(i)); end
ROn_TD_PSC_x_last =  zeros(1,p.TD_Npop);
for i=1:numel(ROn_TD_PSC_x_last), fprintf(fileID,'%g,',ROn_TD_PSC_x_last(i)); end
ROn_TD_PSC_F_last =  ones(1,p.TD_Npop);
for i=1:numel(ROn_TD_PSC_F_last), fprintf(fileID,'%g,',ROn_TD_PSC_F_last(i)); end
ROn_TD_PSC_P_last =  ones(1,p.TD_Npop);
for i=1:numel(ROn_TD_PSC_P_last), fprintf(fileID,'%g,',ROn_TD_PSC_P_last(i)); end
ROn_TD_PSC_q_last =  ones(1,p.TD_Npop);
for i=1:numel(ROn_TD_PSC_q_last), fprintf(fileID,'%g,',ROn_TD_PSC_q_last(i)); end
ROff_TD_PSC_s_last =  zeros(1,p.TD_Npop);
for i=1:numel(ROff_TD_PSC_s_last), fprintf(fileID,'%g,',ROff_TD_PSC_s_last(i)); end
ROff_TD_PSC_x_last =  zeros(1,p.TD_Npop);
for i=1:numel(ROff_TD_PSC_x_last), fprintf(fileID,'%g,',ROff_TD_PSC_x_last(i)); end
ROff_TD_PSC_F_last =  ones(1,p.TD_Npop);
for i=1:numel(ROff_TD_PSC_F_last), fprintf(fileID,'%g,',ROff_TD_PSC_F_last(i)); end
ROff_TD_PSC_P_last =  ones(1,p.TD_Npop);
for i=1:numel(ROff_TD_PSC_P_last), fprintf(fileID,'%g,',ROff_TD_PSC_P_last(i)); end
ROff_TD_PSC_q_last =  ones(1,p.TD_Npop);
for i=1:numel(ROff_TD_PSC_q_last), fprintf(fileID,'%g,',ROff_TD_PSC_q_last(i)); end
X_TD_PSC_s_last =  zeros(1,p.TD_Npop);
for i=1:numel(X_TD_PSC_s_last), fprintf(fileID,'%g,',X_TD_PSC_s_last(i)); end
X_TD_PSC_x_last =  zeros(1,p.TD_Npop);
for i=1:numel(X_TD_PSC_x_last), fprintf(fileID,'%g,',X_TD_PSC_x_last(i)); end
X_TD_PSC_F_last =  ones(1,p.TD_Npop);
for i=1:numel(X_TD_PSC_F_last), fprintf(fileID,'%g,',X_TD_PSC_F_last(i)); end
X_TD_PSC_P_last =  ones(1,p.TD_Npop);
for i=1:numel(X_TD_PSC_P_last), fprintf(fileID,'%g,',X_TD_PSC_P_last(i)); end
X_TD_PSC_q_last =  ones(1,p.TD_Npop);
for i=1:numel(X_TD_PSC_q_last), fprintf(fileID,'%g,',X_TD_PSC_q_last(i)); end
C_ROn_PSC3_s_last =  zeros(1,p.ROn_Npop);
for i=1:numel(C_ROn_PSC3_s_last), fprintf(fileID,'%g,',C_ROn_PSC3_s_last(i)); end
C_ROn_PSC3_x_last =  zeros(1,p.ROn_Npop);
for i=1:numel(C_ROn_PSC3_x_last), fprintf(fileID,'%g,',C_ROn_PSC3_x_last(i)); end
C_ROn_PSC3_F_last =  ones(1,p.ROn_Npop);
for i=1:numel(C_ROn_PSC3_F_last), fprintf(fileID,'%g,',C_ROn_PSC3_F_last(i)); end
C_ROn_PSC3_P_last =  ones(1,p.ROn_Npop);
for i=1:numel(C_ROn_PSC3_P_last), fprintf(fileID,'%g,',C_ROn_PSC3_P_last(i)); end
C_ROn_PSC3_q_last =  ones(1,p.ROn_Npop);
for i=1:numel(C_ROn_PSC3_q_last), fprintf(fileID,'%g,',C_ROn_PSC3_q_last(i)); end

% MONITORS:
